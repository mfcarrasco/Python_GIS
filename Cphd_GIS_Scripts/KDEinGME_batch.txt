#KDE loop
#Draft started 6 October 2016; functional 11 October 2016
#Functional? - YES 

#Must create a shapefile from the featureclass(arcpy.FeatureClassToShapefile_conversion(Input_Features, Output_Folder)

#First part: Create kernels from ONE shapefile with IDs listed. Potential in the future to use list.vector for it to find all the different shapefiles in a folder and do it that way.NOTE: If the field name for the PIT IDs is PIT_ID and not "ID", will have to change "ID=" to "PIT_ID="

ids <- c(4537, 3413, 7194, 7208, 7216, 7230, 7231, 7236, 7243, 7251, 7262, 7274); 

for(i in 1:length(ids)){
kde(in = "C:\GIS_Work\Cphd_Locations\ID_Shapefiles2015\Overton_Locations_2015.shp", out=paste("C:\GIS_Work\Cphd_Locations\ID_Shapefiles2015\","kde_",ids[i],".img"), bandwidth="PLUGIN", cellsize=1, where=paste("ID='",ids[i],"'"));}

#Second part: Create Isopleth. Will create Isopleth and Polygon output files. 

list.raster(in="C:\GIS_Work\Cphd_Locations\ID_Shapefiles2015", match="kde_*", namevariable="rasters");

#default variable name is rasterlist

for(i in 1:length(rasterlist) & i in 1:length(rasters)){
isopleth(in =rasterlist[i], out=paste("C:\GIS_Work\Cphd_Locations\ID_Shapefiles2015\",rasters[i],"_isopleth.shp"), poly=paste("C:\GIS_Work\Cphd_Locations\ID_Shapefiles2015\",rasters[i],"_isopleth_poly.shp"), quantiles = c(0.5, 0.95));}

#Third part: merge all the polygon shapefiles into one for ease of reference

list.vector(in="C:\GIS_Work\Cphd_Locations\ID_Shapefiles2015", match="*isopleth_poly.shp");

#default variable name is vectorlist

for(i in 1:length(vectorlist)){
copyfeaturedataset(in=vectorlist[i], out = "C:\GIS_Work\Cphd_Locations\ID_Shapefiles2015\Overton_2015_kde_poly.shp");}

##NOTE: The ID names will be lost; have to input by hand. Also, have to calculate area